kind: serving
metadata:
  name: serving
  tag: ''
  hash: dde2d1190b712171ccc4b5801e9a0dc30cd4b89e
  project: new-project-gilad
spec:
  command: ''
  args: []
  image: mlrun/mlrun
  build:
    commands: []
    code_origin: serving.py
    origin_filename: serving.py
  description: ''
  default_handler: ''
  disable_auto_mount: false
  env:
  - name: V3IO_API
    value: ''
  - name: V3IO_USERNAME
    value: ''
  - name: V3IO_ACCESS_KEY
    value: ''
  - name: V3IO_FRAMESD
    value: ''
  resources:
    requests:
      memory: 1Mi
      cpu: 25m
    limits:
      memory: 20Gi
      cpu: '2'
  priority_class_name: igz-workload-medium
  preemption_mode: prevent
  min_replicas: 1
  max_replicas: 4
  base_spec:
    apiVersion: nuclio.io/v1
    kind: Function
    metadata:
      name: serving
      labels: {}
      annotations:
        nuclio.io/generated_by: function generated from serving.py
    spec:
      runtime: python
      handler: serving:handler
      env: []
      volumes: []
      build:
        commands: []
        noBaseImagesPull: true
        functionSourceCode: aW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBtbHJ1bgppbXBvcnQgb3MKZnJvbSBjbG91ZHBpY2tsZSBpbXBvcnQgbG9hZApmcm9tIG1scnVuLmFydGlmYWN0cyBpbXBvcnQgZ2V0X2FydGlmYWN0X21ldGEKY2xhc3MgTEdCTU1vZGVsKG1scnVuLnNlcnZpbmcuVjJNb2RlbFNlcnZlcik6CiAgICAKICAgIGRlZiBsb2FkKHNlbGYpOgogICAgICAgIG1vZGVsX2ZpbGUsIGV4dHJhX2RhdGEgPSBzZWxmLmdldF9tb2RlbCgnLnBrbCcpCiAgICAgICAgc2VsZi5tb2RlbF9tZXRhID0gZ2V0X2FydGlmYWN0X21ldGEoc2VsZi5tb2RlbF9wYXRoKVswXQogICAgICAgIHNlbGYubW9kZWwgPSBsb2FkKG9wZW4obW9kZWxfZmlsZSwgJ3JiJykpCgogICAgZGVmIHByZWRpY3Qoc2VsZiwgYm9keSk6CiAgICAgICAgdHJ5OgojICAgICAgICAgICAgIHByaW50KCJtb2RlbF9oYXNoIixzZWxmLm1vZGVsX21ldGEuaGFzaCkKICAgICAgICAgICAgZmVhdHMgPSBucC5hc2FycmF5KGJvZHlbJ2lucHV0cyddKQogICAgICAgICAgICByZXN1bHQgPSBzZWxmLm1vZGVsLnByZWRpY3QoZmVhdHMpCiAgICAgICAgICAgIHJlc3BvbnNlID0gW3Jlc3VsdC50b2xpc3QoKSxmIk1vZGVsIEhhc2gge3NlbGYubW9kZWxfbWV0YS5oYXNofSJdCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCJGYWlsZWQgdG8gcHJlZGljdCAlcyIgJSBlKQpmcm9tIG1scnVuLnJ1bnRpbWVzIGltcG9ydCBudWNsaW9faW5pdF9ob29rCmRlZiBpbml0X2NvbnRleHQoY29udGV4dCk6CiAgICBudWNsaW9faW5pdF9ob29rKGNvbnRleHQsIGdsb2JhbHMoKSwgJ3NlcnZpbmdfdjInKQoKZGVmIGhhbmRsZXIoY29udGV4dCwgZXZlbnQpOgogICAgcmV0dXJuIGNvbnRleHQubWxydW5faGFuZGxlcihjb250ZXh0LCBldmVudCkK
  source: ''
  function_kind: serving_v2
  secret_sources: []
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: app.iguazio.com/lifecycle
            operator: NotIn
            values:
            - preemptible
          - key: eks.amazonaws.com/capacityType
            operator: NotIn
            values:
            - SPOT
          - key: node-lifecycle
            operator: NotIn
            values:
            - spot
  tolerations: null
verbose: false
